{% load static %}
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>スクレイピングアプリケーション</title>
  <style>
    body { font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Sans","Yu Gothic",Arial,sans-serif; background:#eee; margin:0; }
    .wrap { max-width:1200; margin:0 auto; padding:48px 16px; }
    .hero { text-align:center; padding:40px 0; color:#fff; background:linear-gradient(180deg,#9aa3a9,#9a9a9a); border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,.1); }
    .hero h1 { margin:0 0 24px; font-size:32px; letter-spacing:.1em; }
    .form { display:flex; gap:12px; justify-content:center; align-items:center; margin-top:8px; }
    .url-input { width:50%; min-width:280px; padding:14px 16px; border-radius:10px; border:1px solid #d0d0d0; outline:none; background:#fff; }
    .btn { padding:12px 28px; border-radius:10px; border:none; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,.15); cursor:pointer; }
    .flash { margin-top:12px; color:#b00020; font-weight:600; text-align:center; }
    .table-wrap{ margin-top:28px; background:#fff; border-radius:12px; padding:16px; box-shadow:0 4px 16px rgba(0,0,0,.08); overflow:auto;}
    table{ width:100%; border-collapse:collapse; table-layout:fixed; }
    th, td{ border:1px solid #ddd; padding:12px; vertical-align:top; }
    th{ background:#f7f7f7; text-align:left; }
    .title-col{ width:15%; }
    .score-col{ width:5%; }
    .abs-col{ width:25%; }
    .text-col{ width:45%; }
    .time-col{ width:10%; }
    .hint{ color:#666; font-size:12px; margin-top:8px; text-align:center; }
  </style>
</head>
<body>
<div class="wrap">
  <div class="hero">
    <h1>スクレイピングアプリケーション</h1>
    <form class="form" method="post" action="{% url 'articles:create' %}">
      {% csrf_token %}
      <input type="url" name="url" class="url-input" placeholder="スクレイピングするURLを入力" required>
      <button class="btn" type="submit">実行</button>
    </form>
    {% if messages %}
      <div class="flash">
        {% for m in messages %}{{ m }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
      </div>
    {% endif %}
    <div class="hint">URLを入力して「実行」を押します。</div>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th class="title-col">タイトル</th>
          <th class="score-col">リスクスコア</th>
          <th class="abs-col">要約</th>
          <th class="text-col">本文</th>
          <th class="time-col">作成日時</th>
        </tr>
      </thead>
      <tbody>
        {% for a in rows %}
        <tr>
          <td>{{ a.title }}</td>
          <td>{{ a.risk_score }}</td>
          <td style="white-space:pre-wrap">{{ a.abstract }}</td>
          <td style="white-space:pre-wrap; max-height:200px; overflow:auto;">{{ a.text }}</td>
          <td>{{ a.pub_date|date:"Y年m月d日 H時i分" }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="5">まだデータがありません。</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</body>